!function(){"use strict";function e(e,t){e.when("/login",{controller:"LoginController",templateUrl:baseUrlView+"auth/login.html",controllerAs:"vm"}).when("/",{controller:"DashboardController",templateUrl:baseUrlView+"dashboard/index.html",controllerAs:"vm"}).when("/pages",{controller:"PagesController",templateUrl:baseUrlView+"pages/index.html",controllerAs:"vm"}).when("/pages/:pageId",{controller:"PagesController",templateUrl:baseUrlView+"pages/details.html",controllerAs:"vm"}).when("/settings",{controller:"SettingsController",templateUrl:baseUrlView+"settings/index.html",controllerAs:"vm"}).otherwise({redirectTo:"/"})}function t(e,t,n,o,i){e.globals=n.get("globals")||{},e.globals.currentUser&&(o.defaults.headers.common.Authorization="Basic "+e.globals.currentUser.authdata),e.$on("$locationChangeStart",function(n,o,i){var a=-1===$.inArray(t.path(),["/login","/register"]),r=e.globals.currentUser;a&&!r&&t.path("/login")}),e.$on("$routeChangeSuccess",function(){Utility.initAdmin()}),i.defineSettings(),e.toggleLoadingState=function(){e.settings.layout.loading=!e.settings.layout.loading},e.showLoadingState=function(){e.settings.layout.loading=!0},e.hideLoadingState=function(){e.settings.layout.loading=!1},e.baseApi=baseApi,e.baseGlobalApi=baseGlobalApi,e.baseUrl=baseUrl,e.baseUrlView=baseUrl+"views/admin/",e.baseUrlDirectiveTemplates=baseUrl+"templates/directives/"}angular.module("app",[]),angular.module("adminApp",["ngRoute","ngCookies","ngResource","app","ngMessages","ui.bootstrap"]).config(e).run(t),e.$inject=["$routeProvider","$locationProvider"],t.$inject=["$rootScope","$location","$cookieStore","$http","SettingsFactory"]}(),function(){"use strict";function e(e){function t(){e.bodyClass="page page-dashboard",e.pageTitle="Dashboard"}var n=this;n.dashboard=t,function(){t()}()}angular.module("adminApp").controller("DashboardController",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n,o,i){function a(t){e.bodyClass="page page-pages",e.pageTitle="Trang nội dung",e.showLoadingState(),m.pages=[],m.paged=1,m.selectedPages={},m.checkedAllPages=!1,r(m.paged,t)}function r(t,n){o.GetAll(t,function(t){m.pages=t.data,m.currentPage=t.current_page,m.perPage=t.per_page,m.totalItems=t.total,e.hideLoadingState(),n&&n()},function(t){m.pages=[],e.hideLoadingState(),n&&n()})}function s(){r(m.currentPage)}function c(){m.pageTemplates=[],o.GetPageTemplates(function(e){m.pageTemplates=e},function(e){m.pageTemplates=[]})}function l(t,n){e.bodyClass="page page-pages-details",e.showLoadingState(),m.currentObject={},o.GetById(t,function(t){m.currentObject=t,e.pageTitle="Chỉnh sửa nội dung - "+m.currentObject.title,e.hideLoadingState(),n&&n()},function(t){m.currentObject={},e.hideLoadingState(),n&&n()}),c()}function u(){o.UpdatePage(m.currentObject,function(e){0==m.currentObject.id&&n.path("pages/"+e.data.id),i.Success("Cập nhật nội dung thành công.",!1),Utility.scrollToTop()},function(e){i.Error("Cập nhật nội dung thất bại.",!1),Utility.scrollToTop()})}function g(){e.bodyClass="page page-pages-details page-create-page",m.currentObject={id:0,position:0,page_template:"",title:"",slug:"",content:"",meta_keywords:"",meta_description:"",status:1},c()}function p(){if(m.checkedAllPages){for(var e={},t=0;t<m.pages.length;t++){var n=m.pages[t].id;e[n]=!0}m.selectedPages=e}else m.selectedPages={}}function d(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&1==e[t]&&n++;return n}function f(){m.pages.length==d(m.selectedPages)?m.checkedAllPages=!0:m.checkedAllPages=!1}function h(e){var t=[];for(var n in m.selectedPages)m.selectedPages.hasOwnProperty(n)&&1==m.selectedPages[n]&&t.push(n);switch(console.log(t),e){case"show":break;case"hide":break;case"delete":}}var m=this;m.pageList=a,m.pageChanged=s,m.savePage=u,m.multiSelect=p,m.changeSelect=f,m.groupActions=h,m.currentPage=1,m.perPage=1,m.totalItems=0,m.maxSize=5,m.currentObject={},m.pages={},function(){t.pageId?0==t.pageId?g():l(t.pageId):a()}()}angular.module("adminApp").controller("PagesController",e),e.$inject=["$rootScope","$routeParams","$location","PageService","FlashMessageService"]}(),function(){"use strict";function e(e,t,n){function o(n){e.bodyClass="page page-settings",e.pageTitle="Thiết lập",e.showLoadingState(),r.allowSave=!1,r.settingItems=[],t.GetAll(function(t){r.settingItems=t,r.allowSave=!0,e.hideLoadingState(),n&&n()},function(t){r.settingItems=[],r.allowSave=!1,e.hideLoadingState(),n&&n()})}function i(){t.UpdateAll(r.settingItems,function(e){o(function(){n.Success("Cập nhật thiết lập thành công.",!1),Utility.scrollToTop()})},function(e){o(function(){n.Error("Cập nhật thiết lập thất bại.",!1),Utility.scrollToTop()})})}function a(){o(function(){n.Info("Đã bỏ qua các thay đổi.",!1),Utility.scrollToTop()})}var r=this;r.settings=o,r.saveSettings=i,r.reload=a,function(){o()}()}angular.module("adminApp").controller("SettingsController",e),e.$inject=["$rootScope","SettingService","FlashMessageService"]}(),function(){"use strict";function e(){return{restrict:"E",link:function(e,t,n){(n.ngClick||""===n.href||"#"===n.href)&&t.on("click",function(e){e.preventDefault()})}}}angular.module("app").directive("a",e)}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel",drFilterByCountry:"="},templateUrl:baseUrlDirectiveTemplates+"city-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,o){}}}function t(e){function t(){e.get(baseGlobalApi+"global/city-list").success(function(e){n.cities=e}).error(function(e){n.cities=[]})}var n=this;n.getAllTimezone=t,n.cities=[],function(){t()}()}angular.module("app").directive("cityList",e),t.$inject=["$http"]}(),function(){"use strict";function e(){return{restrict:"EA",require:"?ngModel",link:function(e,t,n,o){function i(){if(r.length){var e=r.splice(0,1);s.setData(e[0]||"<span></span>",function(){i(),a=!0})}}var a=!1,r=[],s=CKEDITOR.replace(t[0]);s.on("instanceReady",function(e){o&&i()}),t.bind("$destroy",function(){s.destroy(!1)}),o&&(s.on("change",function(){e.$apply(function(){var e=s.getData();"<span></span>"==e&&(e=null),o.$setViewValue(e)})}),o.$render=function(e){void 0===o.$viewValue&&(o.$setViewValue(null),o.$viewValue=null),r.push(o.$viewValue),a&&(a=!1,i())})}}}function t(){}angular.module("app").directive("ckeditor",e),t.$inject=[]}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel"},templateUrl:baseUrlDirectiveTemplates+"country-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,o){}}}function t(e){function t(){e.get(baseGlobalApi+"global/country-list").success(function(e){n.countries=e}).error(function(e){n.countries=[]})}var n=this;n.getAllTimezone=t,n.countries=[],function(){t()}()}angular.module("app").directive("countryList",e),t.$inject=["$http"]}(),function(){"use strict";function e(e){return{restrict:"EA",template:'<div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div>',link:function(t,n,o){e.$on("$locationChangeStart",function(){e.settings.layout.loading=!0}),e.$on("$routeChangeSuccess",function(){e.settings.layout.loading=!1})}}}angular.module("app").directive("spinnerBar",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel"},templateUrl:baseUrlDirectiveTemplates+"timezone-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,o){}}}function t(e){function t(){e.get(baseGlobalApi+"global/timezone-list").success(function(e){n.timezones=e}).error(function(e){n.timezones=[]})}var n=this;n.getAllTimezone=t,n.timezones=[],function(){t()}()}angular.module("app").directive("timezoneList",e),t.$inject=["$http"]}(),function(){"use strict";function e(e){function t(){var t={layout:{loading:!0}};e.settings=t}var n={};return n.defineSettings=t,n}angular.module("app").factory("SettingsFactory",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(){function t(){var t=e.flash;t&&(t.keepAfterLocationChange?t.keepAfterLocationChange=!1:delete e.flash)}e.$on("$locationChangeStart",function(){t()})}function n(t,n){e.flash={message:t,type:"success",keepAfterLocationChange:n}}function o(t,n){e.flash={message:t,type:"error",keepAfterLocationChange:n}}function i(t,n){e.flash={message:t,type:"info",keepAfterLocationChange:n}}function a(t,n){e.flash={message:t,type:"warning",keepAfterLocationChange:n}}var r={};return r.Success=n,r.Error=o,r.Info=i,r.Warning=a,t(),r}angular.module("app").factory("FlashMessageService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(t,n,o){return t||(t=1),e.get(baseApi+"pages",{params:{page:t}}).success(n).error(o)}function n(t,n,o){return e.get(baseApi+"pages/"+t).success(n).error(o)}function o(t,n){return e.get(baseGlobalApi+"global/page-templates").success(t).error(n)}function i(t,n,o){0!=t.id?e.put(baseApi+"pages/"+t.id,t).success(function(e){n&&n(e)}).error(function(e){o&&o(e)}):e.post(baseApi+"pages/create",t).success(function(e){n&&n(e)}).error(function(e){o&&o(e)})}var a={};return a.GetAll=t,a.GetById=n,a.GetPageTemplates=o,a.UpdatePage=i,a}angular.module("app").factory("PageService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){function t(t,n){return e.get(baseApi+"settings").success(t).error(n)}function n(t,n,o){e.post(baseApi+"settings",t).success(function(e){n&&n(e)}).error(function(e){o&&o(e)})}var o={};return o.GetAll=t,o.UpdateAll=n,o}angular.module("app").factory("SettingService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){function t(t,n){return e.get(baseApi+"users").success(t).error(n)}function n(t,n,o,i){e.post(baseApi+"users/authenticate",{username:t,password:n}).success(function(e){o&&o(e)}).error(function(e){i&&i(e)})}var o={};return o.GetAll=t,o.AuthUser=n,o}angular.module("app").factory("UserService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t,n){function o(){e.showLoadingState(),n.Login(i.username,i.password,function(e){n.SetCredentials(i.username,i.password),t.path("/")},function(t){e.hideLoadingState(),i.error=t.error,i.errorMessage=t.message})}var i=this;i.login=o,function(){n.ClearCredentials(),e.bodyClass="page page-login"}()}angular.module("app").controller("LoginController",e),e.$inject=["$rootScope","$location","AuthenticationService"]}(),function(){"use strict";function e(e,n,o,i,a){function r(e,t,n,o){a.AuthUser(e,t,n,o)}function s(i,a){var r=t.encode(i+":"+a);o.globals={currentUser:{username:i,authData:r}},e.defaults.headers.common.Authorization="Basic "+r,n.put("globals",o.globals)}function c(){o.globals={},n.remove("globals"),e.defaults.headers.common.Authorization="Basic"}var l={};return l.Login=r,l.SetCredentials=s,l.ClearCredentials=c,l}angular.module("app").factory("AuthenticationService",e),e.$inject=["$http","$cookieStore","$rootScope","$timeout","UserService"];var t={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,o,i,a,r="",s="",c="",l=0;do t=e.charCodeAt(l++),n=e.charCodeAt(l++),s=e.charCodeAt(l++),o=t>>2,i=(3&t)<<4|n>>4,a=(15&n)<<2|s>>6,c=63&s,isNaN(n)?a=c=64:isNaN(s)&&(c=64),r=r+this.keyStr.charAt(o)+this.keyStr.charAt(i)+this.keyStr.charAt(a)+this.keyStr.charAt(c),t=n=s="",o=i=a=c="";while(l<e.length);return r},decode:function(e){var t,n,o,i,a,r="",s="",c="",l=0,u=/[^A-Za-z0-9\+\/\=]/g;u.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=this.keyStr.indexOf(e.charAt(l++)),i=this.keyStr.indexOf(e.charAt(l++)),a=this.keyStr.indexOf(e.charAt(l++)),c=this.keyStr.indexOf(e.charAt(l++)),t=o<<2|i>>4,n=(15&i)<<4|a>>2,s=(3&a)<<6|c,r+=String.fromCharCode(t),64!=a&&(r+=String.fromCharCode(n)),64!=c&&(r+=String.fromCharCode(s)),t=n=s="",o=i=a=c="";while(l<e.length);return r}}}();