!function(){"use strict";function e(e,t){e.when("/login",{controller:"LoginController",templateUrl:baseUrlView+"auth/login.html",controllerAs:"vm"}).when("/",{controller:"DashboardController",templateUrl:baseUrlView+"dashboard/index.html",controllerAs:"vm"}).when("/pages",{controller:"PagesController",templateUrl:baseUrlView+"pages/index.html",controllerAs:"vm"}).when("/pages/:pageId",{controller:"PagesController",templateUrl:baseUrlView+"pages/details.html",controllerAs:"vm"}).when("/settings",{controller:"SettingsController",templateUrl:baseUrlView+"settings/index.html",controllerAs:"vm"}).otherwise({redirectTo:"/"})}function t(e,t,n,i,o){e.globals=n.get("globals")||{},e.globals.currentUser&&(i.defaults.headers.common.Authorization="Basic "+e.globals.currentUser.authdata),e.$on("$locationChangeStart",function(n,i,o){var a=-1===$.inArray(t.path(),["/login","/register"]),r=e.globals.currentUser;a&&!r&&t.path("/login")}),e.$on("$routeChangeSuccess",function(){Utility.initAdmin()}),o.defineSettings(),e.toggleLoadingState=function(){e.settings.layout.loading=!e.settings.layout.loading},e.showLoadingState=function(){e.settings.layout.loading=!0},e.hideLoadingState=function(){e.settings.layout.loading=!1},e.baseApi=baseApi,e.baseGlobalApi=baseGlobalApi,e.baseUrl=baseUrl,e.baseUrlView=baseUrl+"views/admin/",e.baseUrlDirectiveTemplates=baseUrl+"templates/directives/"}angular.module("app",[]),angular.module("adminApp",["ngRoute","ngCookies","ngResource","app","ngMessages","ui.bootstrap"]).config(e).run(t),e.$inject=["$routeProvider","$locationProvider"],t.$inject=["$rootScope","$location","$cookieStore","$http","SettingsFactory"]}(),function(){"use strict";function e(e){function t(){e.bodyClass="page page-dashboard",e.pageTitle="Dashboard"}var n=this;n.dashboard=t,function(){t()}()}angular.module("adminApp").controller("DashboardController",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n,i,o){function a(t){e.bodyClass="page page-pages",e.pageTitle="Trang nội dung",e.showLoadingState(),m.pages=[],m.paged=1,m.selectedPages={},m.checkedAllPages=!1,r(m.paged,t)}function r(t,n){i.GetAll(t,function(t){m.pages=t.data,m.currentPage=t.current_page,m.perPage=t.per_page,m.totalItems=t.total,e.hideLoadingState(),n&&n()},function(t){m.pages=[],e.hideLoadingState(),n&&n()})}function s(){r(m.currentPage)}function c(){m.pageTemplates=[],i.GetPageTemplates(function(e){m.pageTemplates=e},function(e){m.pageTemplates=[]})}function l(t,n){e.bodyClass="page page-pages-details",e.showLoadingState(),m.currentObject={},i.GetById(t,function(t){m.currentObject=t,e.pageTitle="Chỉnh sửa nội dung - "+m.currentObject.title,e.hideLoadingState(),n&&n()},function(t){m.currentObject={},e.hideLoadingState(),n&&n()}),c()}function u(){i.UpdatePage(m.currentObject,function(e){0==m.currentObject.id&&n.path("pages/"+e.data.id),o.Success("Cập nhật nội dung thành công.",!1),Utility.scrollToTop()},function(e){o.Error("Cập nhật nội dung thất bại.",!1),Utility.scrollToTop()})}function g(){e.bodyClass="page page-pages-details page-create-page",m.currentObject={id:0,position:0,page_template:"",title:"",slug:"",content:"",meta_keywords:"",meta_description:"",status:1},c()}function p(){if(m.checkedAllPages){for(var e={},t=0;t<m.pages.length;t++){var n=m.pages[t].id;e[n]=!0}m.selectedPages=e}else m.selectedPages={}}function d(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&1==e[t]&&n++;return n}function f(){m.pages.length==d(m.selectedPages)?m.checkedAllPages=!0:m.checkedAllPages=!1}function h(e){var t=[],n={};for(var a in m.selectedPages)m.selectedPages.hasOwnProperty(a)&&1==m.selectedPages[a]&&t.push(a);switch(e){case"delete":return i.DeletePage(t,function(e){o.Success("Xóa trang thành công.",!1)},function(e){o.Error("Xóa trang thất bại.",!1)});case"show":n.status=1;break;case"hide":n.status=0}i.UpdatePages(t,n,function(e){o.Success("Cập nhật trang thành công.",!1)},function(e){o.Error("Cập nhật trang thất bại.",!1)}),r(m.currentPage)}var m=this;m.pageList=a,m.pageChanged=s,m.savePage=u,m.multiSelect=p,m.changeSelect=f,m.groupActions=h,m.currentPage=1,m.perPage=1,m.totalItems=0,m.maxSize=5,m.currentObject={},m.pages={},function(){t.pageId?0==t.pageId?g():l(t.pageId):a()}()}angular.module("adminApp").controller("PagesController",e),e.$inject=["$rootScope","$routeParams","$location","PageService","FlashMessageService"]}(),function(){"use strict";function e(e,t,n){function i(n){e.bodyClass="page page-settings",e.pageTitle="Thiết lập",e.showLoadingState(),r.allowSave=!1,r.settingItems=[],t.GetAll(function(t){r.settingItems=t,r.allowSave=!0,e.hideLoadingState(),n&&n()},function(t){r.settingItems=[],r.allowSave=!1,e.hideLoadingState(),n&&n()})}function o(){t.UpdateAll(r.settingItems,function(e){i(function(){n.Success("Cập nhật thiết lập thành công.",!1),Utility.scrollToTop()})},function(e){i(function(){n.Error("Cập nhật thiết lập thất bại.",!1),Utility.scrollToTop()})})}function a(){i(function(){n.Info("Đã bỏ qua các thay đổi.",!1),Utility.scrollToTop()})}var r=this;r.settings=i,r.saveSettings=o,r.reload=a,function(){i()}()}angular.module("adminApp").controller("SettingsController",e),e.$inject=["$rootScope","SettingService","FlashMessageService"]}(),function(){"use strict";function e(){return{restrict:"E",link:function(e,t,n){(n.ngClick||""===n.href||"#"===n.href)&&t.on("click",function(e){e.preventDefault()})}}}angular.module("app").directive("a",e)}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel",drFilterByCountry:"="},templateUrl:baseUrlDirectiveTemplates+"city-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,i){}}}function t(e){function t(){e.get(baseGlobalApi+"global/city-list").success(function(e){n.cities=e}).error(function(e){n.cities=[]})}var n=this;n.getAllTimezone=t,n.cities=[],function(){t()}()}angular.module("app").directive("cityList",e),t.$inject=["$http"]}(),function(){"use strict";function e(){return{restrict:"EA",require:"?ngModel",link:function(e,t,n,i){function o(){if(r.length){var e=r.splice(0,1);s.setData(e[0]||"<span></span>",function(){o(),a=!0})}}var a=!1,r=[],s=CKEDITOR.replace(t[0]);s.on("instanceReady",function(e){i&&o()}),t.bind("$destroy",function(){s.destroy(!1)}),i&&(s.on("change",function(){e.$apply(function(){var e=s.getData();"<span></span>"==e&&(e=null),i.$setViewValue(e)})}),i.$render=function(e){void 0===i.$viewValue&&(i.$setViewValue(null),i.$viewValue=null),r.push(i.$viewValue),a&&(a=!1,o())})}}}function t(){}angular.module("app").directive("ckeditor",e),t.$inject=[]}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel"},templateUrl:baseUrlDirectiveTemplates+"country-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,i){}}}function t(e){function t(){e.get(baseGlobalApi+"global/country-list").success(function(e){n.countries=e}).error(function(e){n.countries=[]})}var n=this;n.getAllTimezone=t,n.countries=[],function(){t()}()}angular.module("app").directive("countryList",e),t.$inject=["$http"]}(),function(){"use strict";function e(e){return{restrict:"EA",template:'<div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div>',link:function(t,n,i){e.$on("$locationChangeStart",function(){e.settings.layout.loading=!0}),e.$on("$routeChangeSuccess",function(){e.settings.layout.loading=!1})}}}angular.module("app").directive("spinnerBar",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(){return{restrict:"EA",scope:{drClass:"@",drName:"@",bindModel:"=ngModel"},templateUrl:baseUrlDirectiveTemplates+"timezone-list.directive.html",controller:t,controllerAs:"dr",link:function(e,t,n,i){}}}function t(e){function t(){e.get(baseGlobalApi+"global/timezone-list").success(function(e){n.timezones=e}).error(function(e){n.timezones=[]})}var n=this;n.getAllTimezone=t,n.timezones=[],function(){t()}()}angular.module("app").directive("timezoneList",e),t.$inject=["$http"]}(),function(){"use strict";function e(e){function t(){var t={layout:{loading:!0}};e.settings=t}var n={};return n.defineSettings=t,n}angular.module("app").factory("SettingsFactory",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(){function t(){var t=e.flash;t&&(t.keepAfterLocationChange?t.keepAfterLocationChange=!1:delete e.flash)}e.$on("$locationChangeStart",function(){t()})}function n(t,n){e.flash={message:t,type:"success",keepAfterLocationChange:n}}function i(t,n){e.flash={message:t,type:"error",keepAfterLocationChange:n}}function o(t,n){e.flash={message:t,type:"info",keepAfterLocationChange:n}}function a(t,n){e.flash={message:t,type:"warning",keepAfterLocationChange:n}}var r={};return r.Success=n,r.Error=i,r.Info=o,r.Warning=a,t(),r}angular.module("app").factory("FlashMessageService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(t,n,i){return t||(t=1),e.get(baseApi+"pages",{params:{page:t}}).success(n).error(i)}function n(t,n,i){return e.get(baseApi+"pages/"+t).success(n).error(i)}function i(t,n){return e.get(baseGlobalApi+"global/page-templates").success(t).error(n)}function o(t,n,i){0!=t.id?e.put(baseApi+"pages/"+t.id,t).success(function(e){n&&n(e)}).error(function(e){i&&i(e)}):e.post(baseApi+"pages",t).success(function(e){n&&n(e)}).error(function(e){i&&i(e)})}function a(t,n,i,o){e.put(baseApi+"pages",{ids:t,data:n}).success(function(e){i&&i(e)}).error(function(e){o&&o(e)})}function r(t,n,i){e["delete"](baseApi+"pages",{params:{"ids[]":t}}).success(function(e){n&&n(e)}).error(function(e){i&&i(e)})}var s={};return s.GetAll=t,s.GetById=n,s.GetPageTemplates=i,s.UpdatePage=o,s.DeletePage=r,s.UpdatePages=a,s}angular.module("app").factory("PageService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){function t(t,n){return e.get(baseApi+"settings").success(t).error(n)}function n(t,n,i){e.post(baseApi+"settings",t).success(function(e){n&&n(e)}).error(function(e){i&&i(e)})}var i={};return i.GetAll=t,i.UpdateAll=n,i}angular.module("app").factory("SettingService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){function t(t,n){return e.get(baseApi+"users").success(t).error(n)}function n(t,n,i,o){e.post(baseApi+"users/authenticate",{username:t,password:n}).success(function(e){i&&i(e)}).error(function(e){o&&o(e)})}var i={};return i.GetAll=t,i.AuthUser=n,i}angular.module("app").factory("UserService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t,n){function i(){e.showLoadingState(),n.Login(o.username,o.password,function(e){n.SetCredentials(o.username,o.password),t.path("/")},function(t){e.hideLoadingState(),o.error=t.error,o.errorMessage=t.message})}var o=this;o.login=i,function(){n.ClearCredentials(),e.bodyClass="page page-login"}()}angular.module("app").controller("LoginController",e),e.$inject=["$rootScope","$location","AuthenticationService"]}(),function(){"use strict";function e(e,n,i,o,a){function r(e,t,n,i){a.AuthUser(e,t,n,i)}function s(o,a){var r=t.encode(o+":"+a);i.globals={currentUser:{username:o,authData:r}},e.defaults.headers.common.Authorization="Basic "+r,n.put("globals",i.globals)}function c(){i.globals={},n.remove("globals"),e.defaults.headers.common.Authorization="Basic"}var l={};return l.Login=r,l.SetCredentials=s,l.ClearCredentials=c,l}angular.module("app").factory("AuthenticationService",e),e.$inject=["$http","$cookieStore","$rootScope","$timeout","UserService"];var t={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,i,o,a,r="",s="",c="",l=0;do t=e.charCodeAt(l++),n=e.charCodeAt(l++),s=e.charCodeAt(l++),i=t>>2,o=(3&t)<<4|n>>4,a=(15&n)<<2|s>>6,c=63&s,isNaN(n)?a=c=64:isNaN(s)&&(c=64),r=r+this.keyStr.charAt(i)+this.keyStr.charAt(o)+this.keyStr.charAt(a)+this.keyStr.charAt(c),t=n=s="",i=o=a=c="";while(l<e.length);return r},decode:function(e){var t,n,i,o,a,r="",s="",c="",l=0,u=/[^A-Za-z0-9\+\/\=]/g;u.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do i=this.keyStr.indexOf(e.charAt(l++)),o=this.keyStr.indexOf(e.charAt(l++)),a=this.keyStr.indexOf(e.charAt(l++)),c=this.keyStr.indexOf(e.charAt(l++)),t=i<<2|o>>4,n=(15&o)<<4|a>>2,s=(3&a)<<6|c,r+=String.fromCharCode(t),64!=a&&(r+=String.fromCharCode(n)),64!=c&&(r+=String.fromCharCode(s)),t=n=s="",i=o=a=c="";while(l<e.length);return r}}}();